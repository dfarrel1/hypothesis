

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>hypothesis._settings &mdash; Hypothesis 4.28.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Hypothesis
          

          
          </a>

          
            
            
              <div class="version">
                4.28.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../details.html">Details and advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">What you can generate and how</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extras.html">First-party extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../django.html">Hypothesis for Django users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numpy.html">Hypothesis for the Scientific Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../healthchecks.html">Health checks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../database.html">The Hypothesis Example Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful.html">Stateful testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported.html">Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Some more examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manifesto.html">The Purpose of Hypothesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../endorsements.html">Testimonials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Open Source Projects using Hypothesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../strategies.html">Projects extending Hypothesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Ongoing Hypothesis Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Help and Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../packaging.html">Packaging Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reproducing.html">Reproducing Failures</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Hypothesis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>hypothesis._settings</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for hypothesis._settings</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding=utf-8</span>
<span class="c1">#</span>
<span class="c1"># This file is part of Hypothesis, which may be found at</span>
<span class="c1"># https://github.com/HypothesisWorks/hypothesis/</span>
<span class="c1">#</span>
<span class="c1"># Most of this work is copyright (C) 2013-2019 David R. MacIver</span>
<span class="c1"># (david@drmaciver.com), but it contains contributions by others. See</span>
<span class="c1"># CONTRIBUTING.rst for a full list of people who may hold copyright, and</span>
<span class="c1"># consult the git log if you need to determine who owns an individual</span>
<span class="c1"># contribution.</span>
<span class="c1">#</span>
<span class="c1"># This Source Code Form is subject to the terms of the Mozilla Public License,</span>
<span class="c1"># v. 2.0. If a copy of the MPL was not distributed with this file, You can</span>
<span class="c1"># obtain one at https://mozilla.org/MPL/2.0/.</span>
<span class="c1">#</span>
<span class="c1"># END HEADER</span>

<span class="sd">&quot;&quot;&quot;A module controlling settings for Hypothesis to use in falsification.</span>

<span class="sd">Either an explicit settings object can be used or the default object on</span>
<span class="sd">this module can be modified.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="k">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">IntEnum</span><span class="p">,</span> <span class="n">unique</span>

<span class="kn">import</span> <span class="nn">attr</span>

<span class="kn">from</span> <span class="nn">hypothesis.errors</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">HypothesisDeprecationWarning</span><span class="p">,</span>
    <span class="n">InvalidArgument</span><span class="p">,</span>
    <span class="n">InvalidState</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">hypothesis.internal.compat</span> <span class="k">import</span> <span class="n">integer_types</span><span class="p">,</span> <span class="n">quiet_raise</span><span class="p">,</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">hypothesis.internal.reflection</span> <span class="k">import</span> <span class="n">get_pretty_function_description</span><span class="p">,</span> <span class="n">proxies</span>
<span class="kn">from</span> <span class="nn">hypothesis.internal.validation</span> <span class="k">import</span> <span class="n">check_type</span><span class="p">,</span> <span class="n">try_convert</span>
<span class="kn">from</span> <span class="nn">hypothesis.utils.conventions</span> <span class="k">import</span> <span class="n">UniqueIdentifier</span><span class="p">,</span> <span class="n">not_set</span>
<span class="kn">from</span> <span class="nn">hypothesis.utils.dynamicvariables</span> <span class="k">import</span> <span class="n">DynamicVariable</span>

<span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>  <span class="c1"># noqa</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span>


<span class="n">unlimited</span> <span class="o">=</span> <span class="n">UniqueIdentifier</span><span class="p">(</span><span class="s2">&quot;unlimited&quot;</span><span class="p">)</span>


<span class="n">all_settings</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[str, Setting]</span>


<span class="k">class</span> <span class="nc">settingsProperty</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">show_default</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span> <span class="o">=</span> <span class="n">show_default</span>

    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="c1"># This is a gross hack, but it preserves the old behaviour that</span>
                <span class="c1"># you can change the storage directory and it will be reflected</span>
                <span class="c1"># in the default database.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;database&quot;</span> <span class="ow">and</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">not_set</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">hypothesis.database</span> <span class="k">import</span> <span class="n">ExampleDatabase</span>

                    <span class="n">result</span> <span class="o">=</span> <span class="n">ExampleDatabase</span><span class="p">(</span><span class="n">not_set</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Cannot delete attribute </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__doc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">all_settings</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">description</span>
        <span class="n">deprecation_message</span> <span class="o">=</span> <span class="n">all_settings</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">deprecation_message</span>
        <span class="n">default</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">repr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">default</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span>
            <span class="k">else</span> <span class="s2">&quot;(dynamically calculated)&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">description</span><span class="p">,</span>
                <span class="s2">&quot;default value: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">default</span><span class="p">,),</span>
                <span class="p">(</span><span class="n">deprecation_message</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


<span class="n">default_variable</span> <span class="o">=</span> <span class="n">DynamicVariable</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">settingsMeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">settingsMeta</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">default_variable</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s2">&quot;_current_profile&quot;</span><span class="p">):</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">load_profile</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">_current_profile</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">default_variable</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">default_variable</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">_assign_default_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">default_variable</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot assign to the property settings.default - &quot;</span>
                <span class="s2">&quot;consider using settings.load_profile instead.&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">settingsProperty</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot assign hypothesis.settings.</span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2"> - the settings &quot;</span>
                <span class="s2">&quot;class is immutable.  You can change the global default &quot;</span>
                <span class="s2">&quot;settings with settings.load_profile, or use @settings(...) &quot;</span>
                <span class="s2">&quot;to decorate your test instead.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<div class="viewcode-block" id="settings"><a class="viewcode-back" href="../../settings.html#hypothesis.settings">[docs]</a><span class="k">class</span> <span class="nc">settings</span><span class="p">(</span><span class="n">settingsMeta</span><span class="p">(</span><span class="s2">&quot;settings&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,),</span> <span class="p">{})):</span>  <span class="c1"># type: ignore</span>
    <span class="sd">&quot;&quot;&quot;A settings object controls a variety of parameters that are used in</span>
<span class="sd">    falsification. These may control both the falsification strategy and the</span>
<span class="sd">    details of the data that is generated.</span>

<span class="sd">    Default values are picked up from the settings.default object and</span>
<span class="sd">    changes made there will be picked up in newly created settings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_WHITELISTED_REAL_PROPERTIES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_construction_complete&quot;</span><span class="p">,</span> <span class="s2">&quot;storage&quot;</span><span class="p">]</span>
    <span class="n">__definitions_are_locked</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_profiles</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: dict</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">all_settings</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">default</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;settings has no attribute </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># type: (settings, **Any) -&gt; None</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;derandomize&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                    <span class="s2">&quot;derandomize=True implies database=None, so passing &quot;</span>
                    <span class="s2">&quot;database=</span><span class="si">%r</span><span class="s2"> too is invalid.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],)</span>
                <span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_construction_complete</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">deprecations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="n">parent</span> <span class="ow">or</span> <span class="n">settings</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">setting</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">not_set</span><span class="p">)</span> <span class="ow">is</span> <span class="n">not_set</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">setting</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">defaults</span><span class="p">,</span> <span class="n">setting</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">setting</span><span class="o">.</span><span class="n">validator</span><span class="p">:</span>
                        <span class="n">kwargs</span><span class="p">[</span><span class="n">setting</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span><span class="o">.</span><span class="n">validator</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">setting</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">setting</span><span class="o">.</span><span class="n">deprecation_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">deprecations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid argument: </span><span class="si">%r</span><span class="s2"> is not a valid setting&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_construction_complete</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">deprecations</span><span class="p">:</span>
            <span class="n">note_deprecation</span><span class="p">(</span>
                <span class="n">d</span><span class="o">.</span><span class="n">deprecation_message</span><span class="p">,</span>
                <span class="n">since</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">deprecated_since</span><span class="p">,</span>
                <span class="n">verbosity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make the settings object (self) an attribute of the test.</span>

<span class="sd">        The settings are later discovered by looking them up on the test</span>
<span class="sd">        itself.</span>

<span class="sd">        Also, we want to issue a deprecation warning for settings used alone</span>
<span class="sd">        (without @given) so, note the deprecation in the new test, but also</span>
<span class="sd">        attach the version without the warning as an attribute, so that @given</span>
<span class="sd">        can unwrap it (since if @given is used, that means we don&#39;t want the</span>
<span class="sd">        deprecation warning).</span>

<span class="sd">        When it&#39;s time to turn the warning into an error, we&#39;ll raise an</span>
<span class="sd">        exception instead of calling note_deprecation (and can delete</span>
<span class="sd">        &quot;test(*args, **kwargs)&quot;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                <span class="s2">&quot;settings objects can be called as a decorator with @given, &quot;</span>
                <span class="s2">&quot;but test=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">test</span><span class="p">,)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
            <span class="kn">from</span> <span class="nn">hypothesis.stateful</span> <span class="k">import</span> <span class="n">GenericStateMachine</span>

            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">GenericStateMachine</span><span class="p">):</span>
                <span class="n">attr_name</span> <span class="o">=</span> <span class="s2">&quot;_hypothesis_internal_settings_applied&quot;</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                        <span class="s2">&quot;Applying the @settings decorator twice would &quot;</span>
                        <span class="s2">&quot;overwrite the first version; merge their arguments &quot;</span>
                        <span class="s2">&quot;instead.&quot;</span>
                    <span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="n">test</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span>
                <span class="k">return</span> <span class="n">test</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                    <span class="s2">&quot;@settings(...) can only be used as a decorator on &quot;</span>
                    <span class="s2">&quot;functions, or on subclasses of GenericStateMachine.&quot;</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s2">&quot;_hypothesis_internal_settings_applied&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> has already been decorated with a settings object.&quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    Previous:  </span><span class="si">%r</span><span class="se">\n</span><span class="s2">    This:  </span><span class="si">%r</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span>
                    <span class="n">get_pretty_function_description</span><span class="p">(</span><span class="n">test</span><span class="p">),</span>
                    <span class="n">test</span><span class="o">.</span><span class="n">_hypothesis_internal_use_settings</span><span class="p">,</span>
                    <span class="bp">self</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">test</span><span class="o">.</span><span class="n">_hypothesis_internal_use_settings</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="c1"># For double-@settings check:</span>
        <span class="n">test</span><span class="o">.</span><span class="n">_hypothesis_internal_settings_applied</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="nd">@proxies</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">new_test</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                <span class="s2">&quot;Using `@settings` on a test without `@given` is completely pointless.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># @given will get the test from this attribution (rather than use the</span>
        <span class="c1"># version with the deprecation warning)</span>
        <span class="n">new_test</span><span class="o">.</span><span class="n">_hypothesis_internal_test_function_without_warning</span> <span class="o">=</span> <span class="n">test</span>

        <span class="c1"># This means @given has been applied, so we don&#39;t need to worry about</span>
        <span class="c1"># warning for @settings alone.</span>
        <span class="n">has_given_applied</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s2">&quot;is_hypothesis_test&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">test_to_use</span> <span class="o">=</span> <span class="n">test</span> <span class="k">if</span> <span class="n">has_given_applied</span> <span class="k">else</span> <span class="n">new_test</span>
        <span class="n">test_to_use</span><span class="o">.</span><span class="n">_hypothesis_internal_use_settings</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Can&#39;t use _hypothesis_internal_use_settings as an indicator that</span>
        <span class="c1"># @settings was applied, because @given also assigns that attribute.</span>
        <span class="n">test</span><span class="o">.</span><span class="n">_hypothesis_internal_settings_applied</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">test_to_use</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_define_setting</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">default</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">validator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">deprecation_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">deprecated_since</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new setting.</span>

<span class="sd">        - name is the name of the property that will be used to access the</span>
<span class="sd">          setting. This must be a valid python identifier.</span>
<span class="sd">        - description will appear in the property&#39;s docstring</span>
<span class="sd">        - default is the default value. This may be a zero argument</span>
<span class="sd">          function in which case it is evaluated and its result is stored</span>
<span class="sd">          the first time it is accessed on any given settings object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">__definitions_are_locked</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidState</span><span class="p">(</span>
                <span class="s2">&quot;settings have been locked and may no longer be defined.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">default</span> <span class="ow">in</span> <span class="n">options</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">validator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">all_settings</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Setting</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
            <span class="n">validator</span><span class="o">=</span><span class="n">validator</span><span class="p">,</span>
            <span class="n">deprecation_message</span><span class="o">=</span><span class="n">deprecation_message</span><span class="p">,</span>
            <span class="n">deprecated_since</span><span class="o">=</span><span class="n">deprecated_since</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">settingsProperty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">show_default</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">lock_further_definitions</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">__definitions_are_locked</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">_WHITELISTED_REAL_PROPERTIES</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construction_complete</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="s2">&quot;settings objects are immutable and may not be assigned to&quot;</span>
                    <span class="s2">&quot; after construction.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">setting</span> <span class="o">=</span> <span class="n">all_settings</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">setting</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">setting</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                        <span class="s2">&quot;Invalid </span><span class="si">%s</span><span class="s2">, </span><span class="si">%r</span><span class="s2">. Valid options: </span><span class="si">%r</span><span class="s2">&quot;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">setting</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;No such setting </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="c1"># The only settings that are not shown are those that are</span>
            <span class="c1"># deprecated and left at their default values.</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">setting</span><span class="o">.</span><span class="n">default</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">setting</span><span class="o">.</span><span class="n">deprecation_message</span><span class="p">:</span>
                <span class="n">bits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;settings(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">bits</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">show_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">all_settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">setting</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
                <span class="n">bits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>

<div class="viewcode-block" id="settings.register_profile"><a class="viewcode-back" href="../../settings.html#hypothesis.settings.register_profile">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">register_profile</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># type: (str, settings, **Any) -&gt; None</span>
        <span class="sd">&quot;&quot;&quot;Registers a collection of values to be used as a settings profile.</span>

<span class="sd">        Settings profiles can be loaded by name - for example, you might</span>
<span class="sd">        create a &#39;fast&#39; profile which runs fewer examples, keep the &#39;default&#39;</span>
<span class="sd">        profile, and create a &#39;ci&#39; profile that increases the number of</span>
<span class="sd">        examples and uses a different database to store failures.</span>

<span class="sd">        The arguments to this method are exactly as for</span>
<span class="sd">        :class:`~hypothesis.settings`: optional ``parent`` settings, and</span>
<span class="sd">        keyword arguments for each setting that will be set differently to</span>
<span class="sd">        parent (or settings.default, if parent is None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_type</span><span class="p">(</span><span class="n">string_types</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">_profiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="settings.get_profile"><a class="viewcode-back" href="../../settings.html#hypothesis.settings.get_profile">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_profile</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="c1"># type: (str) -&gt; settings</span>
        <span class="sd">&quot;&quot;&quot;Return the profile with the given name.&quot;&quot;&quot;</span>
        <span class="n">check_type</span><span class="p">(</span><span class="n">string_types</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">settings</span><span class="o">.</span><span class="n">_profiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span><span class="s2">&quot;Profile </span><span class="si">%r</span><span class="s2"> is not registered&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,))</span></div>

<div class="viewcode-block" id="settings.load_profile"><a class="viewcode-back" href="../../settings.html#hypothesis.settings.load_profile">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_profile</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="c1"># type: (str) -&gt; None</span>
        <span class="sd">&quot;&quot;&quot;Loads in the settings defined in the profile provided.</span>

<span class="sd">        If the profile does not exist, InvalidArgument will be raised.</span>
<span class="sd">        Any setting not defined in the profile will be the library</span>
<span class="sd">        defined default for that setting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_type</span><span class="p">(</span><span class="n">string_types</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">_current_profile</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">_assign_default_internal</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">get_profile</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div></div>


<span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">local_settings</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">default_context_manager</span> <span class="o">=</span> <span class="n">default_variable</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">default_context_manager</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">s</span>


<span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">Setting</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">default</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">validator</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">deprecation_message</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">deprecated_since</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_ensure_positive_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">since</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
        <span class="n">note_deprecation</span><span class="p">(</span>
            <span class="s2">&quot;Passing non-integer </span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2"> is deprecated&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">since</span><span class="o">=</span><span class="n">since</span>
        <span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">try_convert</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">min_value</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2"> must be at least </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">min_value</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">_max_examples_validator</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">_ensure_positive_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;max_examples&quot;</span><span class="p">,</span> <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-03-06&quot;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">note_deprecation</span><span class="p">(</span>
            <span class="s2">&quot;max_examples=</span><span class="si">%r</span><span class="s2"> should be at least one. You can disable example &quot;</span>
            <span class="s2">&quot;generation with the `phases` setting instead.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,),</span>
            <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-03-06&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;max_examples&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_max_examples_validator</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Once this many satisfying examples have been considered without finding any</span>
<span class="s2">counter-example, falsification will terminate.</span>

<span class="s2">The default value is chosen to suit a workflow where the test will be part of</span>
<span class="s2">a suite that is regularly executed locally or on a CI server, balancing total</span>
<span class="s2">running time against the chance of missing a bug.</span>

<span class="s2">If you are writing one-off tests, running tens of thousands of examples is</span>
<span class="s2">quite reasonable as Hypothesis may miss uncommon bugs with default settings.</span>
<span class="s2">For very complex code, we have observed Hypothesis finding novel bugs after</span>
<span class="s2">*several million* examples while testing :pypi:`SymPy`.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;buffer_size&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="n">not_set</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_ensure_positive_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;buffer_size&quot;</span><span class="p">,</span> <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-03-06&quot;</span><span class="p">),</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The buffer_size setting has been deprecated and no longer does anything.&quot;</span><span class="p">,</span>
    <span class="n">deprecation_message</span><span class="o">=</span><span class="s2">&quot;The buffer_size setting can safely be removed with no effect.&quot;</span><span class="p">,</span>
    <span class="n">deprecated_since</span><span class="o">=</span><span class="s2">&quot;2019-07-03&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="n">not_set</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The timeout setting has been deprecated and no longer does anything.&quot;</span><span class="p">,</span>
    <span class="n">deprecation_message</span><span class="o">=</span><span class="s2">&quot;The timeout setting can safely be removed with no effect.&quot;</span><span class="p">,</span>
    <span class="n">deprecated_since</span><span class="o">=</span><span class="s2">&quot;2017-11-02&quot;</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="n">not_set</span><span class="p">,</span> <span class="n">unlimited</span><span class="p">),</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">_derandomize_validator</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">note_deprecation</span><span class="p">(</span><span class="s2">&quot;derandomize=</span><span class="si">%r</span><span class="s2"> should be a bool.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,),</span> <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-03-06&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;derandomize&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_derandomize_validator</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">If this is True then hypothesis will run in deterministic mode</span>
<span class="s2">where each falsification uses a random number generator that is seeded</span>
<span class="s2">based on the hypothesis to falsify, which will be consistent across</span>
<span class="s2">multiple runs. This has the advantage that it will eliminate any</span>
<span class="s2">randomness from your tests, which may be preferable for some situations.</span>
<span class="s2">It does have the disadvantage of making your tests less likely to</span>
<span class="s2">find novel breakages.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">_validate_database</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">hypothesis.database</span> <span class="k">import</span> <span class="n">ExampleDatabase</span>

    <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">ExampleDatabase</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">db</span>
    <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
        <span class="s2">&quot;Arguments to the database setting must be None or an instance of &quot;</span>
        <span class="s2">&quot;ExampleDatabase.  Try passing database=ExampleDatabase(</span><span class="si">%r</span><span class="s2">), or &quot;</span>
        <span class="s2">&quot;construct and use one of the specific subclasses in &quot;</span>
        <span class="s2">&quot;hypothesis.database&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db</span><span class="p">,)</span>
    <span class="p">)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;database&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="n">not_set</span><span class="p">,</span>
    <span class="n">show_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">An instance of hypothesis.database.ExampleDatabase that will be</span>
<span class="s2">used to save examples to and load previous examples from. May be None</span>
<span class="s2">in which case no storage will be used, `:memory:` for an in-memory</span>
<span class="s2">database, or any path for a directory-based example database.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_validate_database</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@unique</span>
<span class="k">class</span> <span class="nc">Phase</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">explicit</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">reuse</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">generate</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">shrink</span> <span class="o">=</span> <span class="mi">3</span>


<div class="viewcode-block" id="HealthCheck"><a class="viewcode-back" href="../../healthchecks.html#hypothesis.HealthCheck">[docs]</a><span class="nd">@unique</span>
<span class="k">class</span> <span class="nc">HealthCheck</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Arguments for :attr:`~hypothesis.settings.suppress_health_check`.</span>

<span class="sd">    Each member of this enum is a type of health check to suppress.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="HealthCheck.all"><a class="viewcode-back" href="../../healthchecks.html#hypothesis.HealthCheck.all">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="c1"># type: () -&gt; List[HealthCheck]</span>
        <span class="n">deprecated</span> <span class="o">=</span> <span class="p">[</span><span class="n">HealthCheck</span><span class="o">.</span><span class="n">hung_test</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">HealthCheck</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deprecated</span><span class="p">]</span></div>

    <span class="n">data_too_large</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="sd">&quot;&quot;&quot;Check for when the typical size of the examples you are generating</span>
<span class="sd">    exceeds the maximum allowed size too often.&quot;&quot;&quot;</span>

    <span class="n">filter_too_much</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="sd">&quot;&quot;&quot;Check for when the test is filtering out too many examples, either</span>
<span class="sd">    through use of :func:`~hypothesis.assume()` or :ref:`filter() &lt;filtering&gt;`,</span>
<span class="sd">    or occasionally for Hypothesis internal reasons.&quot;&quot;&quot;</span>

    <span class="n">too_slow</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="sd">&quot;&quot;&quot;Check for when your data generation is extremely slow and likely to hurt</span>
<span class="sd">    testing.&quot;&quot;&quot;</span>

    <span class="n">return_value</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="sd">&quot;&quot;&quot;Checks if your tests return a non-None value (which will be ignored and</span>
<span class="sd">    is unlikely to do what you want).&quot;&quot;&quot;</span>

    <span class="n">hung_test</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="sd">&quot;&quot;&quot;This health check is deprecated and no longer has any effect.</span>
<span class="sd">    You can use the ``max_examples`` and ``deadline`` settings together to cap</span>
<span class="sd">    the total runtime of your tests, rather than the previous fixed limit.&quot;&quot;&quot;</span>

    <span class="n">large_base_example</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="sd">&quot;&quot;&quot;Checks if the natural example to shrink towards is very large.&quot;&quot;&quot;</span>

    <span class="n">not_a_test_method</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="sd">&quot;&quot;&quot;Checks if :func:`@given &lt;hypothesis.given&gt;` has been applied to a</span>
<span class="sd">    method of :class:`python:unittest.TestCase`.&quot;&quot;&quot;</span></div>


<span class="nd">@unique</span>
<span class="k">class</span> <span class="nc">Statistics</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">never</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">interesting</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">always</span> <span class="o">=</span> <span class="mi">2</span>


<span class="nd">@unique</span>
<span class="k">class</span> <span class="nc">Verbosity</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">quiet</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Verbosity.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;verbosity&quot;</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Verbosity</span><span class="p">),</span>
    <span class="n">default</span><span class="o">=</span><span class="n">Verbosity</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Control the verbosity level of Hypothesis messages&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">_validate_phases</span><span class="p">(</span><span class="n">phases</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">phases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">Phase</span><span class="p">)</span>
    <span class="n">phases</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">phases</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Phase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> is not a valid phase&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">phases</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;phases&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Phase</span><span class="p">),</span>
    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
        <span class="s2">&quot;Control which phases should be run. &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;See :ref:`the full documentation for more details &lt;phases&gt;`&quot;</span>
    <span class="p">),</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_validate_phases</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stateful_step_count&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_ensure_positive_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;stateful_step_count&quot;</span><span class="p">,</span> <span class="s2">&quot;RELEASEDAY&quot;</span><span class="p">),</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Number of steps to run a stateful program for before giving up on it breaking.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;report_multiple_bugs&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Because Hypothesis runs the test many times, it can sometimes find multiple</span>
<span class="s2">bugs in a single run.  Reporting all of them at once is usually very useful,</span>
<span class="s2">but replacing the exceptions can occasionally clash with debuggers.</span>
<span class="s2">If disabled, only the exception with the smallest minimal example is raised.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">validate_health_check_suppressions</span><span class="p">(</span><span class="n">suppressions</span><span class="p">):</span>
    <span class="n">suppressions</span> <span class="o">=</span> <span class="n">try_convert</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">suppressions</span><span class="p">,</span> <span class="s2">&quot;suppress_health_check&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suppressions</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">HealthCheck</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                <span class="s2">&quot;Non-HealthCheck value </span><span class="si">%r</span><span class="s2"> of type </span><span class="si">%s</span><span class="s2"> is invalid in suppress_health_check.&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">HealthCheck</span><span class="o">.</span><span class="n">hung_test</span><span class="p">:</span>
            <span class="n">note_deprecation</span><span class="p">(</span>
                <span class="s2">&quot;HealthCheck.hung_test is deprecated and has no &quot;</span>
                <span class="s2">&quot;effect, as we no longer run this health check.&quot;</span><span class="p">,</span>
                <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-01-24&quot;</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">suppressions</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;suppress_health_check&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="p">(),</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;A list of health checks to disable.&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">validate_health_check_suppressions</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">duration</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A timedelta specifically measured in milliseconds.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;timedelta(milliseconds=</span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,)</span>


<span class="k">def</span> <span class="nf">_validate_deadline</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">note_deprecation</span><span class="p">(</span>
            <span class="s2">&quot;The deadline=</span><span class="si">%r</span><span class="s2"> must be a duration in milliseconds, or None to disable.&quot;</span>
            <span class="s2">&quot;  Boolean deadlines are treated as ints, and deprecated.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,),</span>
            <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2019-03-06&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">integer_types</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">,)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">duration</span><span class="p">(</span><span class="n">milliseconds</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
            <span class="n">quiet_raise</span><span class="p">(</span>
                <span class="n">InvalidArgument</span><span class="p">(</span>
                    <span class="s2">&quot;deadline=</span><span class="si">%r</span><span class="s2"> is invalid, because it is too large to represent &quot;</span>
                    <span class="s2">&quot;as a timedelta. Use deadline=None to disable deadlines.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
                <span class="s2">&quot;deadline=</span><span class="si">%r</span><span class="s2"> is invalid, because it is impossible to meet a &quot;</span>
                <span class="s2">&quot;deadline &lt;= 0. Use deadline=None to disable deadlines.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
    <span class="k">raise</span> <span class="n">InvalidArgument</span><span class="p">(</span>
        <span class="s2">&quot;deadline=</span><span class="si">%r</span><span class="s2"> (type </span><span class="si">%s</span><span class="s2">) must be a timedelta object, an integer or float number of milliseconds, &quot;</span>
        <span class="s2">&quot;or None to disable the per-test-case deadline.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;deadline&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="n">duration</span><span class="p">(</span><span class="n">milliseconds</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_validate_deadline</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">If set, a duration (as timedelta, or integer or float number of milliseconds)</span>
<span class="s2">that each individual example (i.e. each time your test</span>
<span class="s2">function is called, not the whole decorated test) within a test is not</span>
<span class="s2">allowed to exceed. Tests which take longer than that may be converted into</span>
<span class="s2">errors (but will not necessarily be if close to the deadline, to allow some</span>
<span class="s2">variability in test run time).</span>

<span class="s2">Set this to None to disable this behaviour entirely.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="PrintSettings"><a class="viewcode-back" href="../../reproducing.html#hypothesis.PrintSettings">[docs]</a><span class="k">class</span> <span class="nc">PrintSettings</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flags to determine whether or not to print a detailed example blob to</span>
<span class="sd">    use with :func:`~hypothesis.reproduce_failure` for failing test cases.&quot;&quot;&quot;</span>

    <span class="n">NEVER</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="sd">&quot;&quot;&quot;Never print a blob.&quot;&quot;&quot;</span>

    <span class="n">INFER</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="sd">&quot;&quot;&quot;Make an educated guess as to whether it would be appropriate to print</span>
<span class="sd">    the blob.</span>

<span class="sd">    The current rules are that this will print if:</span>

<span class="sd">    1. The output from Hypothesis appears to be unsuitable for use with</span>
<span class="sd">       :func:`~hypothesis.example`, and</span>
<span class="sd">    2. The output is not too long, and</span>
<span class="sd">    3. Verbosity is at least normal.&quot;&quot;&quot;</span>

    <span class="n">ALWAYS</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="sd">&quot;&quot;&quot;Always print a blob on failure.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;PrintSettings.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span></div>


<span class="k">def</span> <span class="nf">_validate_print_blob</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">replacement</span> <span class="o">=</span> <span class="n">PrintSettings</span><span class="o">.</span><span class="n">ALWAYS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">replacement</span> <span class="o">=</span> <span class="n">PrintSettings</span><span class="o">.</span><span class="n">NEVER</span>

        <span class="n">note_deprecation</span><span class="p">(</span>
            <span class="s2">&quot;Setting print_blob=</span><span class="si">%r</span><span class="s2"> is deprecated and will become an error &quot;</span>
            <span class="s2">&quot;in a future version of Hypothesis. Use print_blob=</span><span class="si">%r</span><span class="s2"> instead.&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">replacement</span><span class="p">),</span>
            <span class="n">since</span><span class="o">=</span><span class="s2">&quot;2018-09-30&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">replacement</span>

    <span class="c1"># Values that aren&#39;t bool or PrintSettings will be turned into hard errors</span>
    <span class="c1"># by the &#39;options&#39; check.</span>
    <span class="k">return</span> <span class="n">value</span>


<span class="n">settings</span><span class="o">.</span><span class="n">_define_setting</span><span class="p">(</span>
    <span class="s2">&quot;print_blob&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="n">PrintSettings</span><span class="o">.</span><span class="n">INFER</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Determines whether to print blobs after tests that can be used to reproduce</span>
<span class="s2">failures.</span>

<span class="s2">See :ref:`the documentation on @reproduce_failure &lt;reproduce_failure&gt;` for</span>
<span class="s2">more details of this behaviour.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">validator</span><span class="o">=</span><span class="n">_validate_print_blob</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">PrintSettings</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">settings</span><span class="o">.</span><span class="n">lock_further_definitions</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">note_deprecation</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">since</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># type: (str, str, Verbosity) -&gt; None</span>
    <span class="k">if</span> <span class="n">verbosity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">verbosity</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">verbosity</span>
    <span class="k">assert</span> <span class="n">verbosity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">since</span> <span class="o">!=</span> <span class="s2">&quot;RELEASEDAY&quot;</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">since</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">date</span>
    <span class="n">warning</span> <span class="o">=</span> <span class="n">HypothesisDeprecationWarning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="n">Verbosity</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">settings</span><span class="o">.</span><span class="n">register_profile</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="p">())</span>
<span class="n">settings</span><span class="o">.</span><span class="n">load_profile</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">settings</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2019, David R. MacIver

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>